' Gambas class file

Public cpu As String
Public flags As String
Public vendor_id As String
Public Sub Form_Open()
  Dim default_display_manager As Boolean = Exist("/etc/X11/default-display-manager")
  Dim cpuz0, cpuz1, cpuz2, cpuz3, cpuz4, cpuz5, cpuz6, cpuz7, cpuz8, cpuz9, cpuz10, cpuz11 As String
  If User.Name = "root" Then
    Message.Error(("Running as root is not allowed!"))
  Endif
  Finfosys.TabStrip1[9].Visible = False
  Debug "Settings default dir = " & Settings.DefaultDir & ""
  Button14.Visible = ChkPrm.ChkExec("udisks")
  Debug "Check for Battery"
  Object.Call(battery, "_inits")
  Debug "Check for Usb device plugged"
  Object.Call(USB_Drives, "_inits")
  Debug "Check for Drives"
  Object.Call(Disk_Drives, "_inits")
  Debug "Check for Drives.."
  Object.Call(Disk_Drives, "_init_2")
  Debug "Check for Drives...."
  Object.Call(Disk_Drives, "get_informations")
  Debug "Check for Input Drives"
  Object.Call(Input_Devices, "_inits")
  Debug "Check available network devices"
  Object.Call(net, "inits")
  Debug "Check available graphic DSub, DVI etc"
  Object.Call(FGraphic, "_inits")
  Debug "Call to Graphic"
  Object.Call(FGraphic, "_check")
  Debug "Check for default display manager"
  If default_display_manager = True Then
   Label4.Visible = True
   TextBox22.Visible = True
   TextBox22.Text = File.Load("/etc/X11/default-display-manager")
   TextBox22.Text = Replace(TextBox22.Text, "\n", "")
   Debug "Default display manager is " & TextBox22.Text
  Endif
  'Check temperature. If temterature is OK then timer start 1500/ms. Check temp 1500/ms
  Timer1.Start
  TextLabel21.Visible = False
  'Procesor
  Debug "Check available procesors"
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '1p'" Wait To cpuz0
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '2p'" Wait To cpuz1
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '3p'" Wait To cpuz2
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '4p'" Wait To cpuz3
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '5p'" Wait To cpuz4
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '6p'" Wait To cpuz5
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '7p'" Wait To cpuz6
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '8p'" Wait To cpuz7
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '9p'" Wait To cpuz8
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '10p'" Wait To cpuz9
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '11p'" Wait To cpuz10
  Shell "ls /sys/devices/system/cpu/ | grep -v save | sed -n '12p'" Wait To cpuz11
  Debug "Replaces new line to space"
  cpuz0 = Replace(cpuz0, "\n", "")
  cpuz1 = Replace(cpuz1, "\n", "")
  cpuz2 = Replace(cpuz2, "\n", "")
  cpuz3 = Replace(cpuz3, "\n", "")
  cpuz4 = Replace(cpuz4, "\n", "")
  cpuz5 = Replace(cpuz5, "\n", "")
  cpuz6 = Replace(cpuz6, "\n", "")
  cpuz7 = Replace(cpuz7, "\n", "")
  cpuz8 = Replace(cpuz8, "\n", "")
  cpuz9 = Replace(cpuz9, "\n", "")
  cpuz10 = Replace(cpuz10, "\n", "")
  cpuz11 = Replace(cpuz11, "\n", "")

  If (cpuz0 = "cpu0") = True Then
      ComboBox1.Add("Processor0")
  Endif
     If (cpuz1 = "cpu1") = True Then
         ComboBox1.Add("Processor1")
     Endif
        If (cpuz2 = "cpu2") = True Then
            ComboBox1.Add("Processor2")
        Endif
           If (cpuz3 = "cpu3") = True Then
               ComboBox1.Add("Processor3")
           Endif
              If (cpuz4 = "cpu4") = True Then
                  ComboBox1.Add("Processor4")
              Endif
                 If (cpuz5 = "cpu5") = True Then
                     ComboBox1.Add("Processor5")
                 Endif
                 If (cpuz6 = "cpu6") = True Then
                     ComboBox1.Add("Processor6")
                 Endif
              If (cpuz7 = "cpu7") = True Then
                  ComboBox1.Add("Processor7")
              Endif
           If (cpuz8 = "cpu8") = True Then
               ComboBox1.Add("Processor8")
           Endif
        If (cpuz9 = "cpu9") = True Then
            ComboBox1.Add("Processor9")
        Endif
     If (cpuz10 = "cpu10") = True Then
         ComboBox1.Add("Processor10")
     Endif
  If (cpuz11 = "cpu11") = True Then
      ComboBox1.Add("Processor11")
  Endif
'Uruchomienie instrukcji dla poszczególnych zakładek w celu wydobycia informacji z systemu
 Debug "Check Dospam uptime"
 dospam_uptime()
 Debug "Check System"
 System()
 Debug "Check Bios"
 bios()
 Debug "Check Kernels"
 kernel()
 Debug "Check sound cards"
 dzwiek()
 Debug "Check graphic card"
 grafika()
 ''END Uruchomienie instrukcji dla poszczególnych zakładek w celu wydobycia informacji z systemu
 Debug "Set Combobox to Processor0"
 ComboBox1.Text = "Processor0" ''Ustawienie combobox na Procesor0 / W przeciwnym wypadku nie pokaże nic
 Label25.Text = Application.Name & " v: " & Application.version
 Debug Label25.Text
 ''Okno na środku
 Me.Center
End

Public Sub ComboBox1_Click()
  Debug "Checking procesors"
  Wykrywanie_procesorow()

End

Public Sub kernel()
  Dim found_kernels, cur_used, All_Kernels, for_add, Kernel_command_line As String
  Dim kernels, i As Integer
  Shell "ls /boot | grep 'vmlinuz*' | wc -l" Wait To All_Kernels
  kernels = Replace(Replace(All_Kernels, " ", ""), "\n", "")
  For i = 1 To kernels
   Shell "ls /boot | grep 'vmlinuz*' | cut -d '/' -f 3 | sed -n '" & i & "p'" Wait To for_add
   for_add = Replace(Replace(for_add, " ", ""), "\n", "")
   ListBox1.Add(for_add, i)
  Next
  Shell "ls /boot/vmlinuz* | cut -d '/' -f 3 | wc -l" Wait To found_kernels
  Shell "uname -r" Wait To cur_used
  Shell "cat /proc/cmdline" Wait To Kernel_command_line
  TextLabel25.Text = "Found " & found_kernels & " kernels:"
  TextLabel26.Text = "Currently used: " & cur_used & ""
  TextArea3.Text = Kernel_command_line
End

Public Sub dzwiek()

  TextArea18.Text = Asound_Drives.sound_cards
  TextBox44.Text = Asound_Drives.Version
  Label18.Text = "Codec:   " & Asound_Drives.Codec
  Label73.Text = "ID:   " & Asound_Drives.Id & "   "
  Label74.Text = "Modules:   " & Asound_Drives.Modules
  Label77.Text = "HWdep:   " & Asound_Drives.hwdep
  Label78.Text = "PCM:   " & Asound_Drives.pcm
  TextArea1.Text = Asound_Drives.Devices

End

Public Sub bios()
  Exec ["cat", "/sys/devices/virtual/dmi/id/board_vendor"] Wait To TextBox23.Text
  Exec ["cat", "/sys/devices/virtual/dmi/id/board_name"] Wait To TextBox24.Text
  Exec ["cat", "/sys/devices/virtual/dmi/id/bios_vendor"] Wait To TextBox25.Text
  Exec ["cat", "/sys/devices/virtual/dmi/id/bios_date"] Wait To TextBox27.Text
  Exec ["cat", "/sys/devices/virtual/dmi/id/bios_version"] Wait To TextBox26.Text
  TextBox23.Text = Replace(TextBox23.Text, "\n", "")
  TextBox24.Text = Replace(TextBox24.Text, "\n", "")
  TextBox25.Text = Replace(TextBox25.Text, "\n", "")
  TextBox26.Text = Replace(TextBox26.Text, "\n", "")
  TextBox27.Text = Replace(TextBox27.Text, "\n", "")
End

Public Sub System()
  Dim hostname, arch, gcc, timezone, xorg_version, glx_version As String
  Shell "cat /etc/timezone || grep ^TIMEZONE= /etc/sysconfig/clock | cut -d '=' -f 2" Wait To timezone
  hostname = System.Host
  arch = System.Architecture
  Shell "gcc -dumpversion" Wait To gcc
  Shell "cat /var/log/Xorg.0.log | grep 'X.Org X Server' | awk {'print $4'}" Wait To xorg_version
  Shell "glxinfo | grep 'GLX version:' | sed -n '1p' | cut -d ':' -f 2" Wait To glx_version
  'Shell "echo $SHELL" Wait To TextBox67.Text
  TextBox67.Text = System.Shell
  TextBox59.Text = Replace(TextBox59.Text, "\n", "")
  TextBox63.Text = Replace(gcc, "\n", "")
  TextBox59.Text = Replace(hostname, "\n", "")
  TextBox66.Text = Replace(arch, "\n", "")
  TextBox62.Text = Replace(timezone, "\n", "")
  TextBox64.Text = Replace(xorg_version, "\n", "")
  TextBox65.Text = Replace(glx_version, "\n", "")
  Distribution_Detect._init
  TextBox60.Text = File.Load("" & User.Home & "/.i-nex/DistributionVendor.conf")
  TextBox61.Text = File.Load("" & User.Home & "/.i-nex/DistributionRelease.conf")
  Replace(Replace(TextBox60.Text, " ", ""), "\n", "")
  Replace(Replace(TextBox61.Text, " ", ""), "\n", "")
End

Public Sub grafika()
  Dim available_resolutions As String
  Dim rozdzielczosc, gpu, memory_prefetchable As String
  Dim opengl_vendor_string, opengl_renderer_string, opengl_version_string As String
  
  If ChkPrm.chkExec("glxinfo") = True Then
    Shell "" & ChkPrm.ChkExecDir("lspci") & " | grep 'VGA' | cut -d ':' -f3 | cut -d '(' -f 1" Wait To gpu
    Shell "glxinfo | grep 'OpenGL vendor string:' | sed -n '1p' | cut -d ':' -f 2" Wait To opengl_vendor_string
    Shell "glxinfo | grep 'OpenGL renderer string:' | sed -n '1p' | cut -d ':' -f 2" Wait To opengl_renderer_string
    Shell "glxinfo | grep 'OpenGL version string:' | sed -n '1p' | cut -d ':' -f 2" Wait To opengl_version_string
  Else
    Message.Warning("Not found glxinfo")
  Endif
  
  Shell "xdpyinfo | grep 'dimensions:' | cut -d ':' -f 2" Wait To rozdzielczosc
  Shell "/usr/bin/i-nex-lspci" Wait To memory_prefetchable
  
  'Rozdzielczość
  If ChkPrm.ChkExec("xrandr") = True Then
    Shell "xrandr | grep current | grep 'Screen 0:' | cut -d ':' -f 2" Wait To available_resolutions
    ''Koniec sprawdzenia dostępnych rozdzielczości.
    ''Sprawdzane są tylko rozdzielczości dla Screen 0.
    ''W przyszłości trzeba będzie dać Combobox w którym będzie do wyboru Creen 0, Screen 1 itd.
  Else
    Message.Warning("Not found xrandr")
  Endif
  Label64.Text = "Total Memory: " & Replace(memory_prefetchable, "\n", "")
  Label105.Text = "OpenGL Vendor: " & Replace(opengl_vendor_string, "\n", "")
  Label106.Text = "OpenGL Renderer: " & Replace(opengl_renderer_string, "\n", "")
  Label107.Text = "OpenGL Version: " & Replace(opengl_version_string, "\n", "")
  Label108.Text = "Present resolution: " & Replace(rozdzielczosc, "\n", "")
  TextBox1.Text = RTrim(Replace(gpu, "\n", ""))
  Label109.Text = Replace(available_resolutions, "\n", "")
  Global.kartagraficzna()
End

Public Sub Wykrywanie_procesorow()
  Dim eloaders, eloaders2, eloaders3 As String
  Dim obrazekcpu, cpu_MHz, power_management As String
  Dim model, stepping, cpu_family, bogomips As String
  Dim address_sizes, cache_size, ldata, linstruction As String
  Dim physical_id, cpu_cores, level3cache As String
  
  If ComboBox1.Text = "Processor0" Then
  eloaders = "1p"
  eloaders2 = "cpu0"
  eloaders3 = "1p"
  Endif
  If ComboBox1.Text = "Processor1" Then
  eloaders = "2p"
  eloaders2 = "cpu1"
  eloaders3 = "3p"
  Endif
  If ComboBox1.Text = "Processor2" Then
  eloaders = "3p"
  eloaders2 = "cpu2"
  eloaders3 = "5p"
  Endif
  If ComboBox1.Text = "Processor3" Then
  eloaders = "4p"
  eloaders2 = "cpu3"
  eloaders3 = "7p"
  Endif
  If ComboBox1.Text = "Processor4" Then
  eloaders = "5p"
  eloaders2 = "cpu4"
  eloaders3 = "9p"
  Endif
  If ComboBox1.Text = "Processor5" Then
  eloaders = "6p"
  eloaders2 = "cpu5"
  eloaders3 = "11p"
  Endif
  If ComboBox1.Text = "Processor6" Then
  eloaders = "7p"
  eloaders2 = "cpu6"
  eloaders3 = "13p"
  Endif
  If ComboBox1.Text = "Processor7" Then
  eloaders = "8p"
  eloaders2 = "cpu7"
  eloaders3 = "15p"
  Endif
  If ComboBox1.Text = "Processor8" Then
  eloaders = "9p"
  eloaders2 = "cpu8"
  eloaders3 = "17p"
  Endif
  If ComboBox1.Text = "Processor9" Then
  eloaders = "10p"
  eloaders2 = "cpu9"
  eloaders3 = "19p"
  Endif
  If ComboBox1.Text = "Processor10" Then
  eloaders = "11p"
  eloaders2 = "cpu10"
  eloaders3 = "21p"
  Endif
  If ComboBox1.Text = "Processor11" Then
  eloaders = "12p"
  eloaders2 = "cpu11"
  eloaders3 = "23p"
  Endif
  
  Shell "grep 'vendor_id' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To obrazekcpu
  Shell "grep 'model name' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2 | cut -d '@' -f 1" Wait To cpu
  Shell "grep 'vendor_id' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To vendor_id
  Shell "grep 'flags' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To flags
  Shell "grep 'cpu MHz' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To cpu_MHz
  Shell "grep 'model' /proc/cpuinfo | sed -n '" & eloaders3 & "' | cut -d ':' -f 2" Wait To model
  Shell "grep 'stepping' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To stepping
  Shell "grep 'cpu family' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To cpu_family
  Shell "grep 'bogomips' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To bogomips
  Shell "grep 'address sizes' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To address_sizes
  Shell "cat /sys/devices/system/cpu/" & eloaders2 & "/cache/index2/size" Wait To cache_size
  Shell "cat /sys/devices/system/cpu/" & eloaders2 & "/cache/index0/size" Wait To ldata
  Shell "cat /sys/devices/system/cpu/" & eloaders2 & "/cache/index1/size" Wait To linstruction
  Shell "cat /sys/devices/system/cpu/" & eloaders2 & "/cache/index3/size" Wait To level3cache
  Shell "grep 'siblings' /proc/cpuinfo | sed -n '1p' | cut -d ':' -f 2" Wait To cpu_cores
  Shell "grep 'physical id' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To physical_id
  Shell "grep 'power management' /proc/cpuinfo | sed -n '" & eloaders & "' | cut -d ':' -f 2" Wait To power_management
  Label14.Text = Replace(cpu, "\n", "")
  flags = Replace(flags, "\n", "")
  'FFlags._init
  Label71.Text = "Flags: " & FFlags.instructions
  Label13.Text = Replace(Replace(Replace(vendor_id, "Authentic", ""), "Genuine", ""), "\n", "")
  Label12.Text = Replace(cpu_MHz, "\n", "") & " MHz"
  Label1.Text = "L1 Data:        " & Replace(ldata, "\n", "")
  Label2.Text = "L1 instruction: " & Replace(linstruction, "\n", "")
  Label3.Text = "Level 2:        " & Replace(cache_size, "\n", "")
  Label5.Text = "Level 3:        " & Replace(level3cache, "\n", "")
  Label97.Text = "Family: " & Replace(cpu_family, "\n", "")
  Label6.Text = "Model: " & Replace(model, "\n", "")
  Label7.Text = "Stepping: " & Replace(stepping, "\n", "")
  Label8.Text = "Cores: " & Replace(cpu_cores, "\n", "")
  Label19.Text = "Phy id: " & Replace(physical_id, "\n", "")
  Label10.Text = "Bogomips: " & Replace(bogomips, "\n", "")
  Label11.Text = "Address sizes: " & Replace(address_sizes, "\n", "")
  Label15.Text = "Power mangament: " & Replace(power_management, "\n", "")
  Global.ikonaprocka()
  Debug "Get info from database"
  Object.Call(FCpudb, "_inits")
End

Public Sub Button2_Click()
   ScreenShotM.pic = Desktop.Screenshot(Me.X, Me.Y, Me.W + 4, Me.H + 30)
   If FUdisks.Above = 1 Then
    FUdisks.Hide
   Endif
   If Finfosys.Above = 1 Then
    Finfosys.Hide
   Endif
   ScreenShot.Show
   
End

Public Sub Button1_Click()

  Me.Close
  Debug "Good bye!"
End

Public Sub dospam_uptime()
  Dim total, used, freee, shared, buffers, cached, usedonthistime, swaptotal As String
  Dim dospam, totpam, totalswap, usedswap As String
  Shell "free -m | grep 'Mem' | awk {'print $2'}" Wait To total
  Shell "free -m | awk {'print $3'} | sed -n '2p'" Wait To used
  Shell "free -m | awk {'print $4'} | sed -n '2p'" Wait To freee
  Shell "free -m | awk {'print $5'} | sed -n '2p'" Wait To shared
  Shell "free -m | awk {'print $6'} | sed -n '2p'" Wait To buffers
  Shell "free -m | awk {'print $7'} | sed -n '2p'" Wait To cached
  Shell "free -m | grep - | awk {'print $3'}" To dospam
  Shell "free -m | grep - | awk {'print $3'}" To usedonthistime
  Shell "free -m | grep Mem | awk {'print $2'}" Wait To totpam
  Shell "free -m | grep 'Swap:' | awk {'print $2'}" Wait To swaptotal
  'Obliczanie zajętości swap
  Shell "/sbin/swapon -s | awk {'print $3'} | sed -n '2p'" Wait To totalswap
  Shell "/sbin/swapon -s | awk {'print $4'} | sed -n '2p'" Wait To usedswap
  'Exec ["/sbin/swapon -s ", "awk {'print $3'}", "sed -n '2p'"] Wait To totalswap
  'Exec ["/sbin/swapon -s", "awk {'print $4'}", "sed -n '2p'"] Wait To usedswap
  swaptotal = Replace(swaptotal, "\n", "")
  usedonthistime = Replace(usedonthistime, "\n", "")
  cached = Replace(cached, "\n", "")
  buffers = Replace(buffers, "\n", "")
  shared = Replace(shared, "\n", "")
  freee = Replace(freee, "\n", "")
  used = Replace(used, "\n", "")
  total = Replace(total, "\n", "")
  Label85.Text = "Total:   " & total & " MB"
  Label86.Text = "Used:   " & used & " MB"
  Label87.Text = "Free:   " & freee & " MB"
  Label88.Text = "Shared:   " & shared & " MB"
  Label89.Text = "Buffers:   " & buffers & " MB"
  Label90.Text = "Cached:   " & cached & " MB"
  TextLabel7.Text = usedonthistime & " MB"
  Label91.Text = "SWAP Total:   " & swaptotal & " MB " ""
  Try TextLabel24.Text = (Replace(Replace(usedswap, " ", ""), "\n", "") / 1000) & " MB"
  Exec ["/usr/bin/uptime"] Wait To TextBox58.Text
  TextBox58.Text = Replace(TextBox58.Text, "\n", "")
  Try ProgressBar1.Value = Replace(Replace(dospam, " ", ""), "\n", "") / Replace(Replace(totpam, " ", ""), "\n", "")
  Try ProgressBar4.Value = Replace(Replace(usedswap, " ", ""), "\n", "") / Replace(Replace(totalswap, " ", ""), "\n", "")

End

Public Sub battery_info()
 Debug "Get information Active Battery"
 TextBox7.Text = battery.Present
 TextBox8.Text = battery.Design_capacity
 TextBox9.Text = battery.last_full_capacity
 TextBox10.Text = battery.battery_technology
 TextBox11.Text = battery.design_voltage
 TextBox12.Text = battery.design_capacity_warning
 TextBox13.Text = battery.design_capacity_low
 TextBox14.Text = battery.cycle_count
 TextBox15.Text = battery.capacity_granularity_1
 TextBox16.Text = battery.capacity_granularity_2
 TextBox17.Text = battery.model_number
 TextBox18.Text = battery.serial_number
 TextBox19.Text = battery.battery_type
 TextBox20.Text = battery.OEM_info
 Debug "Get information Active Battery Done"
 
End


Public Sub Button3_Click()
  Debug "Show About Window"
  About.Show

End

Public Sub Button4_Click()

  Desktop.Open("http://www.cpu-world.com/cgi-bin/SearchSite.pl?SEARCH=" & Label14.Text & "&PROCESS=Search")
  Debug "Open website for more informations about your processor"
End

Public Sub Button7_Click()
  Dim dpkg As String
  Dim rpm As String
  Shell "grep '^Status: install ok installed' /var/lib/dpkg/status | wc -l" Wait To dpkg
  Shell "rpm -qa | wc -l" Wait To rpm
  TextLabel21.Visible = True
  TextLabel21.Text = "" & dpkg & " deb, " & rpm & " rpm Packages are installed"
End

Public Sub Button10_Click()

 Object.Call(battery, "_inits")
 Debug "Battery initial"
End

Public Sub ComboBox3_Click()
Disk_Drives.get_informations()
refreshing()
End

Public Sub ComboBox4_Click()

 Disk_Drives._init_2()
 Disk_Drives.get_informations()
 refreshing()
End

Public Sub refreshing()
 
 Label16.Text = "Device model: " & Disk_Drives.device_model & ""
 Label17.Text = "Device vendor: " & Disk_Drives.device_vendor & ""
 Label38.Text = "Device real size: " & Disk_Drives.real_size & ""
 Label39.Text = "Filesystem type: " & Disk_Drives.filesystem_type & ""
 Label41.Text = "Device rev: " & Disk_Drives.device_rev & ""
 Label42.Text = "Max sectors: " & Disk_Drives.max_sectors & ""
 Label43.Text = "State: " & Disk_Drives.device_state & ""
 Label44.Text = "Modalias: " & Disk_Drives.modalias & ""
 Label46.Text = "Ext range: " & Disk_Drives.ext_range & ""
 Label47.Text = "Range: " & Disk_Drives.range & ""
 Label49.Text = "Add random: " & Disk_Drives.add_random & ""
 Label50.Text = "Discard granularity: " & Disk_Drives.discard_granularity & ""
 Label51.Text = "Discard max bytes: " & Disk_Drives.discard_max_bytes & ""
 Label52.Text = "Discard zeroes data: " & Disk_Drives.discard_zeroes_data & ""
 Label53.Text = "HW sector size: " & Disk_Drives.hw_sector_size & ""
 Label54.Text = "Max HW sectors kb: " & Disk_Drives.max_hw_sectors_kb & ""
 Label55.Text = "Max sectors kb: " & Disk_Drives.max_sectors_kb & ""
 Label56.Text = "Max segments: " & Disk_Drives.max_segments & ""
 Label57.Text = "Max segment size: " & Disk_Drives.max_segment_size & ""
 Label58.Text = "Read ahead kb: " & Disk_Drives.read_ahead_kb & ""
 Label59.Text = "Scheduler: " & Disk_Drives.scheduler & ""
 
 If Disk_Drives.removable Like "0" Then
 Label45.Text = "Removable: No"
 Endif
 If Disk_Drives.removable Like "1" Then
 Label45.Text = "Removable: Yes"
 Endif
 If Disk_Drives.Used <> 0 Then
 Try ProgressBar2.Value = Disk_Drives.Used / 100
 ProgressBar2.ToolTip = Disk_Drives.Used & "%"
 Endif
 If Disk_Drives.Used = Null Then
 ProgressBar2.Value = 0
 ProgressBar2.ToolTip = "Unknown"
 Endif
 If Disk_Drives.check_swap Like "" & ComboBox3.Text & "" Then
 Label48.Visible = True
 Else
 Label48.Visible = False
 Endif
 
 TextBox48.Text = Disk_Drives.mount_point
 TextBox52.Text = Disk_Drives.device_uuid
 TextBox53.Text = Disk_Drives.mount_widtch
End

Public Sub ComboBox5_Click()

 USB_Drives.get_informations()

End

Public Sub ComboBox6_Click()

 Asound_Drives._get_informations()

End

Public Sub ComboBox7_Click()

 Input_Devices._get_informations()

End

Public Sub Button12_Click()
 Me.Hide
 FReport_Gen.Show

End

Public Sub Timer1_Timer()
  ''Refresh temp 1500/ms
  dospam_uptime()
  thermal_zone._inits
  If thermal_zone.supporttemp = True Then
   Label93.Text = "Temp: " & (thermal_zone.calculate / 1000) & " C"
  Else
   Label93.Visible = False
  Endif
  
End

Public Sub Button6_Click()

 FModules.Show

End

Public Sub Button13_Click()

 Desktop.Open("http://tuxportal.pl/forum/")
 Debug "Reporting bug to http://tuxportal.pl/forum/"

End

Public Sub ComboBox2_Click()
 net.get_informations_about_net_interface()
 TextBox56.Text = net.subsystem_device
 TextBox57.Text = net.subsystem_vendor
 TextArea4.Text = net.lspci
End

Public Sub Button8_Click()

 FDF.Show

End

Public Sub Button9_Click()

 FNET_R_T.Show

End

Public Sub ComboBox8_Click()

 Object.Call(FGraphic, "_check")

End

Public Sub Button11_Click()

 Desktop.Open("https://www.facebook.com/pages/I-Nex/199567416807891")

End

Public Sub Button14_Click()

 FUdisks.Show

End
